"use strict";(self.webpackChunkopendata_backend_prabulinggih=self.webpackChunkopendata_backend_prabulinggih||[]).push([[2633],{42633:(e,t,n)=>{n.d(t,{EG:()=>g,Ll:()=>Z,R3:()=>w,UH:()=>u,aM:()=>y,fs:()=>m,i0:()=>v});var o=n(37055),i=n(65256),r=n(53430),s=(n(86300),n(76386)),a=n(36693),c=n(67478);const u=",",l={years:365,months:30,days:1,hours:1/24,minutes:1/1440,seconds:1/86400,milliseconds:1/864e5},f=new Set(["integer","small-integer"]);let d=null;function m(e){return(0,r.vE)(e)||(0,r.zD)(e)||(0,r.Ah)(e)}async function g(e){const{field:t,field2:n,field3:o,normalizationField:i,valueExpression:r}=e;let a=[];if(r){if(!d){const{arcadeUtils:e}=await(0,s.l)();d=e}a=d.extractFieldNames(r)}return t&&a.push(t),n&&a.push(n),o&&a.push(o),i&&a.push(i),a}function h(e){return String(e).padStart(2,"0")}function p(e,t,n){let o;return"date"===t||"number"===t?("number"===t&&(e=new Date(e)),o="TIMESTAMP'".concat(n?e.getFullYear():e.getUTCFullYear(),"-").concat(h((n?e.getMonth():e.getUTCMonth())+1),"-").concat(h(n?e.getDate():e.getUTCDate())," ").concat(h(n?e.getHours():e.getUTCHours()),":").concat(h(n?e.getMinutes():e.getUTCMinutes()),":").concat(h(n?e.getSeconds():e.getUTCSeconds()),"'")):o=e,o}function y(e,t,n,o){const{hasQueryEngine:i}=e,r="(".concat(p(n,T(e,n),i)," - ").concat(p(t,T(e,t),i),")");let s=l[o],a="/";return s<1&&(s=1/s,a="*"),{sqlExpression:1===s?r:"(".concat(r," ").concat(a," ").concat(s,")"),sqlWhere:null}}function T(e,t){if(t instanceof Date)return"date";if("number"==typeof t)return"number";if("string"==typeof t){const n=e.getField(t);if("<now>"===t.toLowerCase())return;if((0,r.vE)(n))return"field"}}function w(e,t){const n=t&&e.getField(t);return!!n&&f.has(n.type)}function Z(e){return"cast(".concat(e," as float)")}function v(e,t){const{format:n,timeZoneOptions:r,fieldType:s}=null!==t&&void 0!==t?t:{};let u,l;if(r&&({timeZone:u,timeZoneName:l}=(0,c.hv)(r.layerTimeZone,r.datesInUnknownTimezone,r.viewTimeZone,(0,i.J2)(n||"short-date-short-time"),s)),"string"==typeof e&&isNaN(Date.parse("time-only"===s?"1970-01-01T".concat(e,"Z"):e)))return e;switch(s){case"date-only":{const t=(0,i.J2)(n||"short-date");return"string"==typeof e?(0,i.iS)(e,(0,o.A)({},t)):(0,i.Yq)(e,(0,o.A)((0,o.A)({},t),{},{timeZone:a.n$}))}case"time-only":{const t=(0,i.J2)(n||"short-time");return"string"==typeof e?(0,i.F8)(e,t):(0,i.Yq)(e,(0,o.A)((0,o.A)({},t),{},{timeZone:a.n$}))}case"timestamp-offset":{if(!u&&"string"==typeof e&&new Date(e).toISOString()!==e)return e;const t=n||r?(0,i.J2)(n||"short-date-short-time"):void 0,s=t?(0,o.A)((0,o.A)({},t),{},{timeZone:u,timeZoneName:l}):void 0;return"string"==typeof e?(0,i.Ey)(e,s):(0,i.Yq)(e,s)}default:{const t=n||r?(0,i.J2)(n||"short-date-short-time"):void 0;return(0,i.Yq)("string"==typeof e?new Date(e):e,t?(0,o.A)((0,o.A)({},t),{},{timeZone:u,timeZoneName:l}):void 0)}}}}}]);
//# sourceMappingURL=2633.7e90d48b.chunk.js.map